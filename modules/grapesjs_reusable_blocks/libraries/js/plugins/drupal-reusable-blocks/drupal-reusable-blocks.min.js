!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("jQuery")):"function"==typeof define&&define.amd?define(["jQuery"],t):"object"==typeof exports?exports["drupal-reusable-blocks"]=t(require("jQuery")):e["drupal-reusable-blocks"]=t(e.jQuery)}(self,(function(e){return(()=>{"use strict";var t={580:(e,t,o)=>{o.r(t),o.d(t,{default:()=>m});var r=o(609),n=o.n(r);const a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=e.BlockManager,r=e.Commands,a=e.Modal,l=e.getConfig().stylePrefix,c=document.createElement("button");c.type="button",c.innerHTML=t.modalSaveButtonLabel,c.className=l+"btn-prim "+l+"btn-import",c.onclick=function(r){var c=n()(r.target).parent(".create-block-form"),u=n()(".status-message",c),i=e.getSelected(),s=e.CodeManager.getCode(i,"css",{cssc:e.CssComposer}),d=s&&"<style>".concat(s,"</style>"),b=n()('[name="block-title"]',c).val(),p=d+i.toHTML();u.empty(),n().post(t.block_create_route,{title:b,body:p}).then((function(e){var r="drupal-reusable-block-".concat(e.id);o.add(r,{label:e.label,category:t.category,attributes:{class:"fa fa-drupal"},content:{type:"drupal-reusable-block",attributes:{"block-plugin-id":e.id}}}),a.close()})).catch((function(e){u.append(n()("<div/>",{html:e.responseJSON,class:l+"alert-error"}))}))};var u=n()("<div/>",{class:"create-block-form"}).append(n()("<div/>",{class:"status-message"}),n()("<div/>",{class:l+"form-item form-item"}).append(n()("<label/>",{class:l+"form-required form-required",for:"block-title",text:t.modalNameInputLabel}),n()("<input />",{class:l+"form-text form-text required",id:"block-title",name:"block-title",type:"text",required:"required"})),c);r.add(t.commandId,{run:function(){var e=this;a.open({title:t.modalTitle,content:u}).onceClose((function(){return e.stopCommand()}))},stop:function(){a.close()}})};var l=function(e){e.model.empty().components().add({tagName:"div",attributes:{class:"gjs-drupal-block"},content:'<div class="lds-dual-ring"></div> '+Drupal.t("Loading...")})},c=function e(t){t.forEach((function(t){t.set({badgable:!1,copyable:!1,draggable:!1,highlightable:!1,hoverable:!1,selectable:!1,removable:!1}),t.components().length>0&&e(t.components())}))},u=function(e,t,o){t.model.empty().components().add(o),function(e,t){var o=e.BlockManager,r=t.model.getAttributes();if(void 0!==r["block-plugin-id"]){var n="drupal-block-".concat(r["block-plugin-id"]),a=o.get(n);a&&t.model.set("name",a.get("label"))}}(e,t),c(t.model.components())};const i=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=e.DomComponents;o.addType("drupal-reusable-block",{isComponent:function(){return!1},view:{init:function(o){0===o.model.components().length&&(l(o),n().get(t.block_route,o.model.get("attributes")).then((function(e){o.model.empty().replaceWith(e)})).catch((function(t){u(e,o,{tagName:"div",attributes:{class:"gjs-drupal-block gjs-block-error"},content:t.responseJSON})})))}}}),e.on("component:selected",(function(e){var o=e.get("toolbar");o&&(o.some((function(e){return e.command===t.commandId}))||(o.unshift({command:t.commandId,label:'<i class="fa fa-recycle"/>'}),e.set("toolbar",o)))}))},s=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=e.BlockManager;t.blocks.forEach((function(e){var r=e.plugin_id,n=e.label,a="drupal-reusable-block-".concat(r);o.add(a,{label:n,category:t.category,attributes:{class:"fa fa-drupal"},content:{type:"drupal-reusable-block",attributes:{"block-plugin-id":r}}})}))};function d(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,r)}return o}function b(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?d(Object(o),!0).forEach((function(t){p(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):d(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function p(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}const m=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=b({category:{id:"drupal-reusable-blocks",label:Drupal.t("Drupal Reusable Blocks"),open:!1,order:40},commandId:"tb-reusable-block-modal",modalTitle:Drupal.t("Reusable block"),modalNameInputLabel:Drupal.t("Reusable block name"),modalSaveButtonLabel:Drupal.t("Save")},t);a(e,o),i(e,o),s(e,o)}},609:t=>{t.exports=e}},o={};function r(e){if(o[e])return o[e].exports;var n=o[e]={exports:{}};return t[e](n,n.exports,r),n.exports}return r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var o in t)r.o(t,o)&&!r.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r(580)})()}));